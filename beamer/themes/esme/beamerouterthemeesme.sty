\mode<presentation>
% Frame title
\defbeamertemplate*{frametitle}{esme}[1][]
{%
  \begin{beamercolorbox}[wd=\paperwidth,ht=1.2cm]{frametitle}
  \begin{tikzpicture}
  \useasboundingbox[fill=white](0,0) rectangle(\the\paperwidth,1.2);
  \fill[bleuesme] (0,0) rectangle(\the\paperwidth,1.4);
  \shade[bottom color=vertesme, top color=bleuesme] (0,0) rectangle +(0.75cm,-\the\paperheight);
  \draw[white,line width=2pt] (0.5,0) rectangle(1.1\paperwidth,1.4);
  \ifx\insertframesubtitle\@empty%
      {\node[anchor=west, white,font=\large] at (0.5,0.6){\insertframetitle};}
  \else%
      {\node[anchor= west, white,font=\large] at (0.5,0.81){\insertframetitle};%
       \node[anchor= west, white,font=\small] at (0.5,0.41){\insertframesubtitle};}%
  \fi
  \end{tikzpicture}
  \end{beamercolorbox}
}
\defbeamertemplate{frametitle}{question}{%
  \begin{beamercolorbox}[wd=\paperwidth,ht=1.2cm]{frametitle}
  \begin{tikzpicture}
  \useasboundingbox[fill=white](0,0) rectangle(\the\paperwidth,1.2);

  \fill[bleuesme] (0,0) rectangle(\the\paperwidth,1.4);
  \shade[bottom color=vertesme, top color=bleuesme] (0,0) rectangle +(0.75cm,-\the\paperheight);
  \draw[white,line width=2pt] (0.5,0) rectangle(1.1\paperwidth,1.4);
   \ifx\insertframesubtitle\@empty%
      {\node[anchor=west, white,font=\large] at (0.5,0.6){\insertframetitle};}
   \else%
      {\node[anchor= west, white,font=\large] at (0.5,0.81){\insertframetitle};%
       \node[anchor= west, white,font=\small] at (0.5,0.41){\insertframesubtitle};}%
   \fi
  \node[anchor=south west] at (0.92\paperwidth,0.08) 
  {\includegraphics[width=0.05\paperwidth]{icone_question}};
  \end{tikzpicture}
  \end{beamercolorbox}
}
\defbeamertemplate{frametitle}{reponse}{%
  \begin{beamercolorbox}[wd=\paperwidth,ht=1.2cm]{frametitle} 
  \begin{tikzpicture}
  \useasboundingbox[fill=white](0,0) rectangle(\the\paperwidth,1.2);
  \fill[bleuesme] (0,0) rectangle(\the\paperwidth,1.4);
  \shade[bottom color=vertesme, top color=bleuesme] (0,0) rectangle +(0.75cm,-\the\paperheight);
  \draw[white,line width=2pt] (0.5,0) rectangle(1.1\paperwidth,1.4);
   \ifx\insertframesubtitle\@empty%
      {\node[anchor=west, white,font=\large] at (0.5,0.6){\insertframetitle};}
   \else%
      {\node[anchor= west, white,font=\large] at (0.5,0.81){\insertframetitle};%
       \node[anchor= west, white,font=\small] at (0.5,0.41){\insertframesubtitle};}%
   \fi
  \node[anchor=south west] at (0.92\paperwidth,0.08) 
  {\includegraphics[width=0.05\paperwidth]{icone_reponse}};
  \end{tikzpicture}
  \end{beamercolorbox}
}

\BeforeBeginEnvironment{frame}{%
  \setbeamertemplate{frametitle}[esme]%
}
\makeatletter
\define@key{beamerframe}{question}[true]{%
    \setbeamertemplate{frametitle}[question]%
}
\define@key{beamerframe}{reponse}[true]{%
    \setbeamertemplate{frametitle}[reponse]%
}
\makeatother

\defbeamertemplate*{footline}{esme}[1][]
{
  \ifnum \theframenumber=1
  \else
  \ifinsectionframe%
  \else
  \hbox{
  \includegraphics[height=0.6cm]{ESME_LOGO_SEUL_BLANC_2021}%
  \begin{beamercolorbox}[wd=.5\paperwidth,ht=2.25ex,dp=1ex,right]{section in head/foot}%
    \usebeamerfont{section in head/foot}\insertsection
  \end{beamercolorbox}
  \begin{beamercolorbox}[wd=.44\paperwidth,ht=2.25ex,dp=1ex,right]{pagenumber in head/foot}%
    \usebeamerfont{pagenumber in head/foot}\insertframenumber{} 
  \end{beamercolorbox}
  }%
  \fi
  \fi
}
\mode<all>
